<!DOCTYPE HTML>
<html lang="en">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <!--THIS FILE IS GENERATED FROM AN XML TEMPLATE. DO NOT EDIT!-->
      <title>Music Encoding Initiative Guidelines</title>
      <meta name="author" content="Johannes Kepper">
      <meta name="author" content="Perry D. Roland">
      <meta name="subject" content="Documentation for the Music Encoding Initiative (MEI) Data Model">
      <meta name="keywords" content="Music Encoding, MEI, Digital Humanities, Musicology, Music Librarianship, Music Information Retrieval">
      <meta name="date" content="2025-01-22">
      <meta name="generator" content="MEI XSLT stylesheets">
      <meta name="DC.Title" content="Music Encoding Initiative Guidelines">
      <meta name="DC.Type" content="Text">
      <meta name="DC.Format" content="text/html">
      <link rel="stylesheet" media="screen" type="text/css" href="../assets/css/screen/search.css">
      <link rel="stylesheet" media="screen" type="text/css" href="../assets/css/screen/mei-website.css">
      <link rel="stylesheet" media="screen" type="text/css" href="../assets/css/screen/mei-screen.css"><script src="../assets/js/searchIndex.js"></script><script src="../assets/js/fuse.min.js"></script></head>
   <body class="simple" id="TOP">
      <div class="headerBar"></div>
      <div class="container-fluid content">
         <div class="columns specsLayout">
            <div class="top-navigation column col-md-12 show-md">
               <div class="top-navigation-header columns">
                  <div class="buttonbox"><button class="btn btn-action btn-sm btn-primary" id="topNavigationShow"><i class="icon icon-menu"></i></button></div>
                  <div class="searchbox">
                     <form>
                        <div class="search_group"><input id="search_inputTop" class="search_input" title="At least 3 characters" type="text"><button type="submit" id="submitSearchButtonTop" class="search_button"><span class="search_icon">⚲</span></button></div>
                     </form>
                  </div>
               </div>
            </div>
            <div class="column col-8 col-md-12">
               <div id="search-content"></div>
               <section class="div1">
                  
                  <h1 id="integration"><span class="headingNumber">14</span><span class="head">Integrating MEI with other Standards and Formats</span></h1>
                  
                  <p>In this chapter, the combination of MEI with other relevant formats in the field is
                     covered. Here, the MEI Guidelines try to serve as Best Practice Recommendations; they
                     don't claim to provide full and / or authoritative documentation for those other
                     formats. The intention is to provide good starting points and share experience across
                     various projects, trying to unify both tools and workflows for better efficiency.
                     Accordingly, if the information found here provides as outdated or incomplete, please
                     <a class="link_ref link_external" href="https://music-encoding.org/community/community-contacts.html">get in
                        touch</a>. </p>
                  
                  <div class="div2">
                     
                     <h2 id="tei"><span class="headingNumber">14.1</span><span class="head">TEI</span></h2>
                     
                     <p>The TEI’s Special Interest Group on Music has come up with an ODD customization
                        for TEI, which allows to embed MEI excerpts into TEI. However, the SIG Music is
                        officially considered <em>dormant</em>, so the information provided
                        is somewhat outdated. The most recent resources are available from <a class="link_ref link_external" href="https://github.com/TEI-Music-SIG/tei-mei/">GitHub</a>.</p>
                     
                     <p>As of yet, no official MEI customization to include elements from the TEI
                        namespace into MEI has been written, even though this is definitely wanted. </p>
                     </div>
                  
                  <div class="div2">
                     
                     <h2 id="iiif"><span class="headingNumber">14.2</span><span class="head">IIIF</span></h2>
                     
                     <p>This chapter will explain how to use MEI in an IIIF-compatible way.</p>
                     </div>
                  
                  <div class="div2">
                     
                     <h2 id="smufl"><span class="headingNumber">14.3</span><span class="head">SMuFL</span></h2>
                     
                     <p>This section describes how to use MEI with the Standard Music Font Layout (SMuFL,
                        <a class="link_ref link_external" href="https://www.smufl.org/">https://www.smufl.org/</a>)
                        specification.</p>
                     </div>
                  
                  <div class="div2">
                     
                     <h2 id="svg"><span class="headingNumber">14.4</span><span class="head">SVG</span></h2>
                     
                     <p>In order to use Scalable Vector Graphics (SVG) in MEI, a new <em>module</em> needs to be
                        compiled into ODD (see <a class="link_ptr chapterLink" title="Customizing MEI" href="../content/introduction.html#meiCustomization">1.3.5 Customizing MEI</a> for an
                        introduction on how to do that). In order to do that, you need to enter the
                        following <a class="link_odd_elementSpec" href="https://tei-c.org/release/doc/tei-p5-doc/en/html/ref-moduleRef.html">tei:moduleRef</a> into the <a class="link_odd_elementSpec" href="https://tei-c.org/release/doc/tei-p5-doc/en/html/ref-schemaSpec.html">tei:schemaSpec</a> of your ODD file:</p>
                     
                     <p>
                        
                        <figure class="figure specPage">
                           <div id="d18e24823" xml:space="preserve" class="pre code egXML_feasible">
                              <code>
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 <div class="indent indent1"><span data-indentation="1" class="element">&lt;moduleRef <span class="attribute">url=</span><span class="attributevalue">"http://www.w3.org/Graphics/SVG/1.1/rng/svg11.rng"</span>&gt;</span>
                                    
                                    <div class="indent indent2"><span data-indentation="2" class="element">&lt;content&gt;</span>
                                       
                                       <div class="indent indent3"><span data-indentation="3" class="element">&lt;rng:define <span class="attribute">name=</span><span class="attributevalue">"mei_model.graphicLike"</span> <span class="attribute">combine=</span><span class="attributevalue">"choice"</span>&gt;</span>
                                          <span data-indentation="4" class="element">&lt;rng:ref <span class="attribute">name=</span><span class="attributevalue">"<a class="link_odd link_external_module" href="#svg">svg</a>"</span>&gt;</span><span data-indentation="4" class="element">&lt;/rng:ref&gt;</span>
                                          <span data-indentation="3" class="element">&lt;/rng:define&gt;</span></div>
                                       <span data-indentation="2" class="element">&lt;/content&gt;</span></div>
                                    <span data-indentation="1" class="element">&lt;/moduleRef&gt;</span></div>
                                 
                                 
                                 
                                 
                                 
                                 </code>
                              
                              </div>
                           <figcaption class="figure-caption">Listing 481. </figcaption>
                        </figure>
                        </p>
                     
                     <p>With this addition, which can be added to any of the provided customizations of
                        MEI (see <a class="link_ptr chapterLink" title="MEI Profiles" href="../content/introduction.html#meiProfiles">1.3.4 MEI Profiles</a>), the <a class="link_ref link_external" href="https://www.w3.org/TR/SVG11/struct.html#SVGElement">&lt;svg&gt;</a>
                        element becomes available everywhere `model.graphicLike` (<abbr>i.e.</abbr>, the <a class="link_odd link_odd_elementSpec" href="../elements/graphic.html">graphic</a> element) is currently allowed, that is: inside of <a class="link_odd link_odd_elementSpec" href="../elements/fig.html">fig</a>, <a class="link_odd link_odd_elementSpec" href="../elements/incip.html">incip</a>, <a class="link_odd link_odd_elementSpec" href="../elements/surface.html">surface</a>, and <a class="link_odd link_odd_elementSpec" href="../elements/zone.html">zone</a>.</p>
                     
                     <p> In the following example, an <a class="link_ref link_external" href="https://www.w3.org/TR/SVG11/paths.html#PathElement">&lt;svg:path&gt;</a> element is inserted into a <a class="link_odd link_odd_elementSpec" href="../elements/surface.html">surface</a>. It would now be possible for measures or other music features to
                        point to the rectangular <a class="link_odd link_odd_elementSpec" href="../elements/zone.html">zone</a> in MEI namespace, or the fancy
                        shaped <a class="link_ref link_external" href="https://www.w3.org/TR/SVG11/paths.html#PathElement">&lt;svg:path&gt;</a> using their <span class="att">facs</span> attribute (see <a class="link_ptr chapterLink" title="Elements of the Facsimile Module" href="../content/facsimilesrecordings.html#facsimileElements">12.1.1 Elements of the Facsimile Module</a> for that mechanism). It’s equally possible to use
                        SVG content inside figures on title pages or anywhere else.</p>
                     
                     <p>
                        
                        <figure class="figure specPage">
                           <div id="d18e24897" xml:space="preserve" class="pre code egXML_feasible">
                              <code>
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 <div class="indent indent1"><span data-indentation="1" class="element">&lt;surface <span class="attribute">lrx=</span><span class="attributevalue">"3000"</span> <span class="attribute">lry=</span><span class="attributevalue">"2000"</span> <span class="attribute">ulx=</span><span class="attributevalue">"0"</span> <span class="attribute">uly=</span><span class="attributevalue">"0"</span>&gt;</span>
                                    <span data-indentation="2" class="element">&lt;graphic <span class="attribute">target=</span><span class="attributevalue">"image1.jpg"</span> <span class="attribute">width=</span><span class="attributevalue">"3000px"</span> <span class="attribute">height=</span><span class="attributevalue">"2000px"</span>&gt;</span><span data-indentation="2" class="element">&lt;/graphic&gt;</span>
                                    
                                    <div class="indent indent2"><span data-indentation="2" class="element">&lt;svg:svg <span class="attribute">version=</span><span class="attributevalue">"1.1"</span> <span class="attribute">width=</span><span class="attributevalue">"3000px"</span> <span class="attribute">height=</span><span class="attributevalue">"2000px"</span> <span class="attribute">viewBox=</span><span class="attributevalue">"0 0 3000 2000"</span>&gt;</span>
                                       
                                       <div class="indent indent3"><span data-indentation="3" class="element">&lt;svg:path <span class="attribute">id=</span><span class="attributevalue">"fancyShape"</span> <span class="attribute">fill=</span><span class="attributevalue">"#ff0000"</span> <span class="attribute">d=</span><span class="attributevalue">"…"</span>/&gt;</span></div>
                                       <span data-indentation="2" class="element">&lt;/svg:svg&gt;</span></div>
                                    
                                    <div class="indent indent2"><span data-indentation="2" class="element">&lt;zone <span class="attribute">xml:id=</span><span class="attributevalue">"rectangle"</span> <span class="attribute">lrx=</span><span class="attributevalue">"370"</span> <span class="attribute">lry=</span><span class="attributevalue">"410"</span> <span class="attribute">ulx=</span><span class="attributevalue">"300"</span> <span class="attribute">uly=</span><span class="attributevalue">"200"</span>/&gt;</span></div>
                                    <span data-indentation="1" class="element">&lt;/surface&gt;</span></div>
                                 
                                 
                                 
                                 
                                 </code>
                              
                              </div>
                           <figcaption class="figure-caption">Listing 482. </figcaption>
                        </figure>
                        </p>
                     
                     <p>Of course it’s possible to allow elements in SVG namespace in other places in MEI
                        as well, by adjusting the model classes that the SVG namespace shall join.</p>
                     </div>
                  
                  <div class="div2">
                     
                     <h2 id="midiGuidelines"><span class="headingNumber">14.5</span><span class="head">Musical Instrument Digital Interface (MIDI)</span></h2>
                     
                     <p>This chapter describes the MIDI encoding functionality present in MEI. The purpose
                        of this module is to allow for integrating MIDI data into MEI-encoded notation, to
                        both aid software in translating MEI to MIDI, and to permit the capture of
                        information in files that have been translated from MIDI to MEI. The MIDI model in
                        MEI is similar to that of Mup, and the user is directed to the <a class="link_ref link_external" href="http://www.arkkra.com/doc/uguide.ps">Mup User Guide</a> for further
                        reading.</p>
                     
                     <p>The MIDI module defines certain generally-accepted MIDI units that may be used
                        outside of a MIDI context. For example, the <span class="att">dur.ppq</span> attribute accepts
                        MIDI <em>ppq</em> (Pulses Per Quarter) as a valid measurement of
                        duration. Similarly, the <span class="att">pnum</span> attribute allows MIDI note numbers for
                        specifying a pitch value.</p>
                     
                     <div class="div3">
                        
                        <h3 id="midi.scoreDefppq"><span class="headingNumber">14.5.1</span><span class="head">PPQ in scoreDef and staffDef</span></h3>
                        
                        <p>To define the MIDI resolution of a score, the <span class="att">ppq</span> attribute may be
                           used on the <a class="link_odd link_odd_elementSpec" href="../elements/scoreDef.html">scoreDef</a> element. This value can be used to
                           interpret the values found in the <span class="att">dur.ppq</span> attribute on elements in
                           the <a class="link_odd link_odd_attClass" href="../attribute-classes/att.duration.ges.html">att.duration.ges</a> class.</p>
                        
                        <p>
                           
                           <figure class="figure specPage">
                              <div id="d18e24968" xml:space="preserve" class="pre code egXML_feasible">
                                 <code>
                                    
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;scoreDef <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">meter.count=</span><span class="attributevalue">"4"</span> <span class="attribute">meter.sym=</span><span class="attributevalue">"common"</span> <span class="attribute">meter.unit=</span><span class="attributevalue">"4"</span> <span class="attribute">ppq=</span><span class="attributevalue">"48"</span>&gt;</span>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;staffGrp&gt;</span>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"2"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"G"</span> <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"1"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P1"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"4"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"F"</span> <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"2"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P2"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"4"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"F"</span> <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"3"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P3"</span>/&gt;</span></div>
                                          <span data-indentation="2" class="element">&lt;/staffGrp&gt;</span></div>
                                       <span data-indentation="1" class="element">&lt;/scoreDef&gt;</span></div>
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="comment">&lt;!-- snip --&gt;</span></div>
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;note <span class="attribute">dur=</span><span class="attributevalue">"8"</span> <span class="attribute">dur.ges=</span><span class="attributevalue">"24p"</span> <span class="attribute">oct=</span><span class="attributevalue">"5"</span> <span class="attribute">pname=</span><span class="attributevalue">"a"</span> <span class="attribute">stem.dir=</span><span class="attributevalue">"up"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.d1e40"</span>/&gt;</span></div>
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="comment">&lt;!-- 8th note --&gt;</span></div>
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;rest <span class="attribute">dur=</span><span class="attributevalue">"32"</span> <span class="attribute">dur.ges=</span><span class="attributevalue">"6p"</span> <span class="attribute">vo=</span><span class="attributevalue">"4"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.d1e58"</span>/&gt;</span></div>
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="comment">&lt;!-- 32nd note --&gt;</span></div>
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="comment">&lt;!-- snip --&gt;</span></div>
                                    
                                    
                                    </code>
                                 
                                 </div>
                              <figcaption class="figure-caption">Listing 483. </figcaption>
                           </figure>
                           </p>
                        
                        <p>The <span class="att">ppq</span> attribute is also available on the <a class="link_odd link_odd_elementSpec" href="../elements/staffDef.html">staffDef</a> element in order to aid in the conversion to MEI from other
                           representations that allow a different time base for each staff. However, these
                           independent values for <span class="att">ppq</span> are only interpretable in terms of a
                           common time base. Therefore, the <span class="att">ppq</span> attribute is required on <a class="link_odd link_odd_elementSpec" href="../elements/scoreDef.html">scoreDef</a> when the values of <span class="att">ppq</span> on the staff
                           definitions differ. In the following example, the values of the <span class="att">ppq</span>
                           attributes on the <a class="link_odd link_odd_elementSpec" href="../elements/staffDef.html">staffDef</a> elements are all factors of
                           the value of <span class="att">ppq</span> attached to <a class="link_odd link_odd_elementSpec" href="../elements/scoreDef.html">scoreDef</a>.</p>
                        
                        <p>
                           
                           <figure class="figure specPage">
                              <div id="d18e25007" xml:space="preserve" class="pre code egXML_feasible">
                                 <code>
                                    
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;scoreDef <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">meter.count=</span><span class="attributevalue">"4"</span> <span class="attribute">meter.sym=</span><span class="attributevalue">"common"</span> <span class="attribute">meter.unit=</span><span class="attributevalue">"4"</span> <span class="attribute">ppq=</span><span class="attributevalue">"48"</span>&gt;</span>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;staffGrp&gt;</span>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"2"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"G"</span> <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"1"</span> <span class="attribute">ppq=</span><span class="attributevalue">"2"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P1"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"4"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"F"</span> <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"2"</span> <span class="attribute">ppq=</span><span class="attributevalue">"16"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P2"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"4"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"F"</span> <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"3"</span> <span class="attribute">ppq=</span><span class="attributevalue">"24"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P3"</span>/&gt;</span></div>
                                          <span data-indentation="2" class="element">&lt;/staffGrp&gt;</span></div>
                                       <span data-indentation="1" class="element">&lt;/scoreDef&gt;</span></div>
                                    
                                    
                                    
                                    </code>
                                 
                                 </div>
                              <figcaption class="figure-caption">Listing 484. </figcaption>
                           </figure>
                           </p>
                        </div>
                     
                     <div class="div3">
                        
                        <h3 id="midiInstruments"><span class="headingNumber">14.5.2</span><span class="head">Recording General MIDI Instrumentation</span></h3>
                        
                        <p>The <a class="link_odd link_odd_elementSpec" href="../elements/instrDef.html">instrDef</a> element can be used to record MIDI
                           instrument names or numbers using the <span class="att">midi.instrname</span> and
                           <span class="att">midi.instrnum</span> attributes. The <span class="att">midi.instrname</span> attribute
                           must contain an instrument name from the list provided by the data.MIDINAMES
                           data type. By default, data.MIDINAMES contains General MIDI Instrument
                           designations.</p>
                        
                        <p>
                           
                           <figure class="figure specPage">
                              <div id="d18e25035" xml:space="preserve" class="pre code egXML_feasible">
                                 <code>
                                    
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;scoreDef <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">meter.count=</span><span class="attributevalue">"4"</span> <span class="attribute">meter.sym=</span><span class="attributevalue">"common"</span> <span class="attribute">meter.unit=</span><span class="attributevalue">"4"</span> <span class="attribute">ppq=</span><span class="attributevalue">"48"</span>&gt;</span>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;staffGrp&gt;</span>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"2"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"G"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"1"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P5"</span>&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;instrDef <span class="attribute">midi.instrname=</span><span class="attributevalue">"Violin"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/staffDef&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"2"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"G"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"2"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P6"</span>&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;instrDef <span class="attribute">midi.instrname=</span><span class="attributevalue">"Violin"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/staffDef&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"3"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"C"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"3"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P7"</span>&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;instrDef <span class="attribute">midi.instrname=</span><span class="attributevalue">"Viola"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/staffDef&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"4"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"F"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"3"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P8"</span>&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;instrDef <span class="attribute">midi.instrname=</span><span class="attributevalue">"Cello"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/staffDef&gt;</span></div>
                                          <span data-indentation="2" class="element">&lt;/staffGrp&gt;</span></div>
                                       <span data-indentation="1" class="element">&lt;/scoreDef&gt;</span></div>
                                    
                                    
                                    
                                    </code>
                                 
                                 </div>
                              <figcaption class="figure-caption">Listing 485. </figcaption>
                           </figure>
                           </p>
                        
                        <p>The <span class="att">midi.instrnum</span> is provided for those cases when an instrument
                           number is needed. It must contain valid MIDI values; that is, 0-127. In these
                           cases, a General MIDI Instrument name is redundant.</p>
                        
                        <p>
                           
                           <figure class="figure specPage">
                              <div id="d18e25051" xml:space="preserve" class="pre code egXML_feasible">
                                 <code>
                                    
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;scoreDef <span class="attribute">keysig=</span><span class="attributevalue">"1f"</span> <span class="attribute">meter.count=</span><span class="attributevalue">"4"</span> <span class="attribute">meter.sym=</span><span class="attributevalue">"common"</span> <span class="attribute">meter.unit=</span><span class="attributevalue">"4"</span> <span class="attribute">ppq=</span><span class="attributevalue">"48"</span>&gt;</span>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;staffGrp&gt;</span>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"2"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"G"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"1"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P5"</span>&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;instrDef <span class="attribute">midi.instrnum=</span><span class="attributevalue">"41"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/staffDef&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"2"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"G"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"2"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P6"</span>&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;instrDef <span class="attribute">midi.instrnum=</span><span class="attributevalue">"41"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/staffDef&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"3"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"C"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"3"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P7"</span>&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;instrDef <span class="attribute">midi.instrnum=</span><span class="attributevalue">"42"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/staffDef&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;staffDef <span class="attribute">clef.line=</span><span class="attributevalue">"4"</span> <span class="attribute">clef.shape=</span><span class="attributevalue">"F"</span> <span class="attribute">lines=</span><span class="attributevalue">"5"</span> <span class="attribute">n=</span><span class="attributevalue">"3"</span> <span class="attribute">xml:id=</span><span class="attributevalue">"midi.P8"</span>&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;instrDef <span class="attribute">midi.instrnum=</span><span class="attributevalue">"43"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/staffDef&gt;</span></div>
                                          <span data-indentation="2" class="element">&lt;/staffGrp&gt;</span></div>
                                       <span data-indentation="1" class="element">&lt;/scoreDef&gt;</span></div>
                                    
                                    
                                    
                                    </code>
                                 
                                 </div>
                              <figcaption class="figure-caption">Listing 486. </figcaption>
                           </figure>
                           </p>
                        </div>
                     
                     <div class="div3">
                        
                        <h3 id="midiData"><span class="headingNumber">14.5.3</span><span class="head">Recording MIDI Event Data</span></h3>
                        
                        <p>MIDI messages are encapsulated in the <a class="link_odd link_odd_elementSpec" href="../elements/midi.html">midi</a> element, which
                           is typically used in contexts like <a class="link_odd link_odd_elementSpec" href="../elements/layer.html">layer</a> and <a class="link_odd link_odd_elementSpec" href="../elements/measure.html">measure</a>. In earlier versions of MEI, the <a class="link_odd link_odd_elementSpec" href="../elements/noteOn.html">noteOn</a> and <a class="link_odd link_odd_elementSpec" href="../elements/noteOff.html">noteOff</a> elements were used to record
                           MIDI note on/off events. The use of these elements is now discouraged in favor
                           of using the <a class="link_odd link_odd_elementSpec" href="../elements/note.html">note</a> element directly. MIDI duration should
                           be recorded using the <span class="att">dur.ges</span> attribute, and MIDI pitch information
                           should be recorded using the <span class="att">pnum</span> attribute.</p>
                        
                        <p>MIDI control changes (<a class="link_odd link_odd_elementSpec" href="../elements/cc.html">cc</a>) are encoded using the
                           <span class="att">num</span> and <span class="att">val</span> attributes. Control change numbers are
                           specified in the General MIDI documentation. In the example below, the <a class="link_odd link_odd_elementSpec" href="../elements/cc.html">cc</a> elements encode increasing controller event 7 (volume)
                           values, or in musical terms, a crescendo. Other MIDI event messages follow this
                           same pattern, using the <span class="att">num</span> and <span class="att">val</span> attributes to record
                           the raw MIDI data.</p>
                        
                        <p>
                           
                           <figure class="figure specPage">
                              <div id="d18e25112" xml:space="preserve" class="pre code egXML_feasible">
                                 <code>
                                    
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;measure&gt;</span>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;staff&gt;</span>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;layer&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;note <span class="attribute">dur.ges=</span><span class="attributevalue">"8"</span> <span class="attribute">pnum=</span><span class="attributevalue">"45"</span>/&gt;</span></div>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;note <span class="attribute">dur.ges=</span><span class="attributevalue">"8"</span> <span class="attribute">pnum=</span><span class="attributevalue">"42"</span>/&gt;</span></div>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;note <span class="attribute">dur.ges=</span><span class="attributevalue">"8"</span> <span class="attribute">pnum=</span><span class="attributevalue">"43"</span>/&gt;</span></div>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;note <span class="attribute">dur.ges=</span><span class="attributevalue">"8"</span> <span class="attribute">pnum=</span><span class="attributevalue">"44"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/layer&gt;</span></div>
                                          <span data-indentation="2" class="element">&lt;/staff&gt;</span></div>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;midi <span class="attribute">layer=</span><span class="attributevalue">"1"</span> <span class="attribute">staff=</span><span class="attributevalue">"1"</span>&gt;</span>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">tstamp=</span><span class="attributevalue">".5"</span> <span class="attribute">val=</span><span class="attributevalue">"50"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">tstamp=</span><span class="attributevalue">"1.5"</span> <span class="attribute">val=</span><span class="attributevalue">"55"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">tstamp=</span><span class="attributevalue">"2"</span> <span class="attribute">val=</span><span class="attributevalue">"60"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">tstamp=</span><span class="attributevalue">"2.5"</span> <span class="attribute">val=</span><span class="attributevalue">"65"</span>/&gt;</span></div>
                                          <span data-indentation="2" class="element">&lt;/midi&gt;</span></div>
                                       <span data-indentation="1" class="element">&lt;/measure&gt;</span></div>
                                    
                                    
                                    
                                    </code>
                                 
                                 </div>
                              <figcaption class="figure-caption">Listing 487. </figcaption>
                           </figure>
                           </p>
                        
                        <p>In the preceding example, each control change is associated with a time stamp.
                           The <span class="att">tstamp</span> attribute is required in order to indicate when the MIDI
                           event should take place. It is often necessary to indicate a time stamp
                           slightly earlier than the affected notes to compensate for MIDI delay.</p>
                        
                        <p>For better legibility and error checking, the <a class="link_odd link_odd_elementSpec" href="../elements/midi.html">midi</a>
                           element may be used, as in the following example, to group MIDI parameter
                           changes. Even so, the <span class="att">tstamp</span> attribute is required on all parameters
                           in order to associate them with their point of actuation:</p>
                        
                        <p>
                           
                           <figure class="figure specPage">
                              <div id="d18e25137" xml:space="preserve" class="pre code egXML_feasible">
                                 <code>
                                    
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;midi <span class="attribute">layer=</span><span class="attributevalue">"1"</span> <span class="attribute">staff=</span><span class="attributevalue">"1"</span>&gt;</span>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">tstamp=</span><span class="attributevalue">".5"</span> <span class="attribute">val=</span><span class="attributevalue">"50"</span>/&gt;</span></div>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"64"</span> <span class="attribute">tstamp=</span><span class="attributevalue">".5"</span> <span class="attribute">val=</span><span class="attributevalue">"64"</span>/&gt;</span></div>
                                       <span data-indentation="1" class="element">&lt;/midi&gt;</span></div>
                                    
                                    
                                    
                                    </code>
                                 
                                 </div>
                              <figcaption class="figure-caption">Listing 488. </figcaption>
                           </figure>
                           </p>
                        </div>
                     
                     <div class="div3">
                        
                        <h3 id="midiNonCMN"><span class="headingNumber">14.5.4</span><span class="head">MIDI in Mensural and Neume Notation</span></h3>
                        
                        <p>In mensural, neume, and other historical or non-Western repertoires, there is
                           often no measure-based time stamp with which to associate MIDI controller data.
                           Therefore, in these notations MIDI controller data is assumed to be associated
                           with the event that immediately follows in the same layer. Thus, a crescendo in
                           mensural notation may be encoded like so:</p>
                        
                        <p>
                           
                           <figure class="figure specPage">
                              <div id="d18e25155" xml:space="preserve" class="pre code egXML_feasible">
                                 <code>
                                    
                                    
                                    <div class="indent indent1"><span data-indentation="1" class="element">&lt;staff&gt;</span>
                                       
                                       <div class="indent indent2"><span data-indentation="2" class="element">&lt;layer&gt;</span>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;midi&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">val=</span><span class="attributevalue">"50"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/midi&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;note <span class="attribute">dur=</span><span class="attributevalue">"fusa"</span> <span class="attribute">dur.ges=</span><span class="attributevalue">"8p"</span> <span class="attribute">pnum=</span><span class="attributevalue">"42"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;midi&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">val=</span><span class="attributevalue">"55"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/midi&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;note <span class="attribute">dur=</span><span class="attributevalue">"fusa"</span> <span class="attribute">dur.ges=</span><span class="attributevalue">"8p"</span> <span class="attribute">pnum=</span><span class="attributevalue">"43"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;midi&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">val=</span><span class="attributevalue">"60"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/midi&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;note <span class="attribute">dur=</span><span class="attributevalue">"fusa"</span> <span class="attribute">dur.ges=</span><span class="attributevalue">"8p"</span> <span class="attribute">pnum=</span><span class="attributevalue">"44"</span>/&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;midi&gt;</span>
                                             
                                             <div class="indent indent4"><span data-indentation="4" class="element">&lt;cc <span class="attribute">num=</span><span class="attributevalue">"7"</span> <span class="attribute">val=</span><span class="attributevalue">"65"</span>/&gt;</span></div>
                                             <span data-indentation="3" class="element">&lt;/midi&gt;</span></div>
                                          
                                          <div class="indent indent3"><span data-indentation="3" class="element">&lt;note <span class="attribute">dur=</span><span class="attributevalue">"fusa"</span> <span class="attribute">dur.ges=</span><span class="attributevalue">"8p"</span> <span class="attribute">pnum=</span><span class="attributevalue">"45"</span>/&gt;</span></div>
                                          <span data-indentation="2" class="element">&lt;/layer&gt;</span></div>
                                       <span data-indentation="1" class="element">&lt;/staff&gt;</span></div>
                                    
                                    
                                    
                                    </code>
                                 
                                 </div>
                              <figcaption class="figure-caption">Listing 489. </figcaption>
                           </figure>
                           </p>
                        </div>
                     </div>
                  </section>
            </div>
            <div class="column col-4 hide-md">
               <div id="guidelinesVersion"><span class="versionLabel">MEI Version: </span><span id="versionID">5.1</span><span class="gitLink">(<a href="https://github.com/music-encoding/music-encoding/commit/9d551da8fba699881cac1c8d209b67b8d44d52e6" target="_blank" rel="noopener noreferrer">#9d551da</a>)</span></div>
               <form>
                  <div class="search_group"><input name="q" id="search_input" class="search_input" title="At least 3 characters" type="text"><button type="submit" id="submitSearchButtonSide" class="search_button"><span class="search_icon">⚲</span></button></div>
               </form>
               <ul class="nav">
                  <li class="nav-item"><a href="../content/index.html">Guidelines</a></li>
                  <li class="nav-item"><a href="../modules.html">Modules</a></li>
                  <li class="nav-item"><a href="../elements.html">Elements</a></li>
                  <li class="nav-item"><a href="../model-classes.html">Model Classes</a></li>
                  <li class="nav-item"><a href="../macro-groups.html">Macro Groups</a></li>
                  <li class="nav-item"><a href="../attribute-classes.html">Attribute Classes</a></li>
                  <li class="nav-item"><a href="../data-types.html">Data Types</a></li>
               </ul>
               <div class="divider"></div>
               <p class="sectionToc sticky"><a class="level-2" href="#tei">14.1 TEI</a><a class="level-2" href="#iiif">14.2 IIIF</a><a class="level-2" href="#smufl">14.3 SMuFL</a><a class="level-2" href="#svg">14.4 SVG</a><a class="level-2" href="#midiGuidelines">14.5 Musical Instrument Digital Interface (MIDI)</a><a class="level-3" href="#midi.scoreDefppq">14.5.1 PPQ in scoreDef and staffDef</a><a class="level-3" href="#midiInstruments">14.5.2 Recording General MIDI Instrumentation</a><a class="level-3" href="#midiData">14.5.3 Recording MIDI Event Data</a><a class="level-3" href="#midiNonCMN">14.5.4 MIDI in Mensural and Neume Notation</a></p>
            </div>
         </div>
         <div class="modal" id="toc-modal"><a href="#close" id="toc-modal-outer-close" class="modal-overlay" aria-label="Close"></a><div class="modal-container">
               <div class="modal-header"><a href="#close" id="toc-modal-inner-close" class="btn btn-clear float-right" aria-label="Close"></a><div class="modal-title h5">Table of Contents</div>
               </div>
               <div class="modal-body">
                  <div class="content">
                     <ul class="nav">
                        <li class="nav-item"><a href="../content/index.html">Guidelines</a></li>
                        <li class="nav-item"><a href="../modules.html">Modules</a></li>
                        <li class="nav-item"><a href="../elements.html">Elements</a></li>
                        <li class="nav-item"><a href="../model-classes.html">Model Classes</a></li>
                        <li class="nav-item"><a href="../macro-groups.html">Macro Groups</a></li>
                        <li class="nav-item"><a href="../attribute-classes.html">Attribute Classes</a></li>
                        <li class="nav-item"><a href="../data-types.html">Data Types</a></li>
                     </ul>
                     <div class="divider"></div>
                     <p class="sectionToc sticky"><a class="level-2" href="#tei">14.1 TEI</a><a class="level-2" href="#iiif">14.2 IIIF</a><a class="level-2" href="#smufl">14.3 SMuFL</a><a class="level-2" href="#svg">14.4 SVG</a><a class="level-2" href="#midiGuidelines">14.5 Musical Instrument Digital Interface (MIDI)</a><a class="level-3" href="#midi.scoreDefppq">14.5.1 PPQ in scoreDef and staffDef</a><a class="level-3" href="#midiInstruments">14.5.2 Recording General MIDI Instrumentation</a><a class="level-3" href="#midiData">14.5.3 Recording MIDI Event Data</a><a class="level-3" href="#midiNonCMN">14.5.4 MIDI in Mensural and Neume Notation</a></p>
                  </div>
               </div>
            </div>
         </div><script>
                                window.addEventListener("load", function(event) {
                                    document.getElementById('topNavigationShow').addEventListener('click',function(e) {
                                        var elem = document.getElementById('toc-modal');
                                        elem.classList.toggle('active');
                                    })
                                    document.getElementById('toc-modal-outer-close').addEventListener('click',function(e) {
                                        var elem = document.getElementById('toc-modal');
                                        elem.classList.toggle('active');
                                    })
                                    document.getElementById('toc-modal-inner-close').addEventListener('click',function(e) {
                                        var elem = document.getElementById('toc-modal');
                                        elem.classList.toggle('active');
                                    })
                                    
                                    function getMenu() {
                                        const fullVersion = '5.1'
                                        const version = (fullVersion.includes('-dev')) ? 'dev' : 'v' + fullVersion.split('.')[0];
                                        console.log('trying to get menu for version ' + version + ' (' + fullVersion + ')');
                                        
                                        const url = 'https://music-encoding.org/menus/' + version + '/menu.html';
                                        
                                        fetch(url)
                                            .then(function(response) { return response.text()})
                                            .then(function(doc) {
                                                let headerBar = document.querySelector('.headerBar');
                                                const parser = new DOMParser();
                                                const htmlDoc = parser.parseFromString(doc, 'text/html');
                                                const menu = htmlDoc.querySelector('.headerBar');
                                                headerBar.parentNode.replaceChild(menu, headerBar);
                                            });
                                    };
                                    getMenu();
                                        
                                });
                            </script></div>
      <div class="modal" id="searchResultsModal"><a id="searchModalCloseBg" href="#" class="modal-overlay" aria-label="Close"></a><div class="modal-container">
            <div class="modal-header"><button id="searchModalCloseLink" class="btn btn-clear float-right" aria-label="Close"></button><div class="modal-title h5">Search Results for "<span id="searchPattern"></span>"</div>
            </div>
            <div class="modal-body">
               <div class="content" id="searchResultsBox"></div>
            </div>
            <div class="modal-footer"><button class="btn" id="searchModalCloseBtn">Close</button></div>
         </div>
      </div><script>
                            const tabbedFacets = document.querySelectorAll('.facet ul.tab');
                            
                            const tabClick = function(e) {
                                const targetDataDisplay = e.target.getAttribute('data-display');
                                const facetId = e.target.parentNode.parentNode.parentNode.parentNode.id;
                                //console.log('clicked at ' + facetId + ' with data display ' + targetDataDisplay);
                                setTabs(facetId,targetDataDisplay);
                            }
                            
                            console.log('[INFO] Javascript initialized')
                            
                            for(let facetUl of tabbedFacets) {
                                const facetElem = facetUl.parentNode?.parentNode;
                                const facetId = facetElem.id;
                                const storageName = getStorageName(facetId);
                                const defaultDataDisplay = facetUl.children[0]?.children[0]?.getAttribute('data-display');
                                
                                if(localStorage.getItem(storageName) === null) {
                                    setTabs(facetId,defaultDataDisplay?.trim());
                                } else {
                                    setTabs(facetId,`${facetId}_${localStorage.getItem(storageName)?.trim()}`);
                                }
                                
                                const tabs = facetUl.querySelectorAll('.tab-item a');
                                
                                for(let tab of tabs) {
                                    tab.addEventListener('click',tabClick);
                                }
                            }

                            function getDisplayStyle(style) {
                                // split dataDisplay string at underscore, e.g. 'attributes_full' to ['attributes','full'] and return the second part of the array
                                const [_, displayStyle = 'compact'] = style.split('_');
                                return displayStyle;
                            }

                            function getStorageName(facetId) {
                                return 'meiSpecs_' + facetId + '_display';
                            }

                            function setTabs(facetId, style) {
                                const storageName = getStorageName(facetId);
                                const displayStyle = getDisplayStyle(style);
                                localStorage.setItem(storageName,displayStyle);
                                
                                const facetElem = document.getElementById(facetId);
                                
                                const oldTab = facetElem.querySelector('.displayTab.active');
                                if (oldTab) {
                                    oldTab.classList.remove('active');
                                }
                                
                                const newTab = document.getElementById(style + '_tab');
                                if (newTab) {
                                    newTab.classList.add('active');
                                }
                                
                                const oldBox = facetElem.querySelector('.active.facetTabbedContent');
                                if (oldBox) {
                                    oldBox.classList.remove('active');
                                    oldBox.style.display = 'none';
                                }
                                
                                const newBox = document.getElementById(style);
                                if(newBox) {
                                    newBox.classList.add('active');
                                    newBox.style.display = 'block';
                                }
                            }
                            
                            const reducedLevels = false;
                            
            /* SEARCH */
            const searchOptions = {
                // isCaseSensitive: false,
                includeScore: true,
                shouldSort: true,
                includeMatches: true,
                // findAllMatches: false,
                minMatchCharLength: 3,
                // location: 0,
                threshold: 0.1,
                // distance: 100,
                // useExtendedSearch: false,
                ignoreLocation: true,
                ignoreFieldNorm: false,
                keys: [
                    { name:"ident",
                      weight: 10 },
                    { name:"desc",
                      weight: 2 },
                    { name:"remarks",
                      weight: 1 }
                ]
            };
            
            //initialize search
            let fuse = new Fuse(searchIndex, searchOptions);
            let searchReady = true;
            
            const searchButton1 = document.querySelector('#submitSearchButtonSide');
            const searchButton2 = document.querySelector('#submitSearchButtonTop');
            const searchInput1 = document.querySelector('#search_input');
            const searchInput2 = document.querySelector('#search_inputTop');
            const searchModal = document.querySelector('#searchResultsModal');
            const searchModalCloseBtn = document.querySelector('#searchModalCloseBtn');
            const searchModalCloseBg = document.querySelector('#searchModalCloseBg');
            const searchModalCloseLink = document.querySelector('#searchModalCloseLink');
            const searchResultsBox = document.querySelector('#searchResultsBox');
            
            function search(pattern) {
                
                let results = fuse.search(pattern)
                console.log(results)
                
                searchResultsBox.innerHTML = '';
                
                document.querySelector('#searchPattern').innerText = pattern;
                
                const pathAdjust = (reducedLevels) ? './' : '../';
                
                results.forEach(hit => {
                    let div = document.createElement('div')
                    div.classList.add('searchHit')
                    div.setAttribute('data-score', hit.score)
                    let a = document.createElement('a')
                    a.setAttribute('href', pathAdjust + hit.item.url)
                    a.classList.add(hit.item.type)
                    a.innerHTML = hit.item.ident
                    div.append(a)
                    
                    if(hit.item.type === 'chapter') {
                        
                        let remarksHits = hit.matches.filter(m => m.key === 'remarks')
                        if(remarksHits.length > 0) {
                        
                            let firstI = remarksHits[0].indices[0][0];
                            let dist = remarksHits[0].indices[0][1] - remarksHits[0].indices[0][0] + 1;
                            let startRaw = firstI - 40;
                            
                            let hitLength = 140;
                            
                            let offset = (0 > startRaw)? 40 - firstI : 0;
                            let startCleaned = startRaw + offset;
                            
                            let prefix = (startCleaned > 0) ? '…': '';
                            let postfix = (remarksHits[0].value.length > hitLength + dist) ? '…': '';
                            
                            let snippet = remarksHits[0].value.substr(startCleaned, hitLength + dist);
                            
                            let pre = prefix + snippet.substr(0, 40 - offset);
                            let match = snippet.substr(40 - offset, dist);
                            let post = snippet.substr(40 - offset + dist) + postfix;
                            
                            let preview = document.createElement('div')
                            preview.classList.add('searchPreview')
                            preview.setAttribute('data-snippet', snippet)
                            
                            let preSpan = document.createElement('span')
                            preSpan.innerHTML = pre
                            preview.append(preSpan)
                            let matchSpan = document.createElement('span')
                            matchSpan.classList.add('match')
                            matchSpan.innerHTML = match
                            preview.append(matchSpan)
                            let postSpan = document.createElement('span')
                            postSpan.innerHTML = post
                            preview.append(postSpan)
                            
                            div.append(preview)
                        }
                    }
                    
                    
                    
                    searchResultsBox.append(div)
                })
                
                searchModal.classList.add('active');
            }
            
            function initSideSearch(e) {
                e.preventDefault();
                const val = searchInput1.value;
                if(!val.length > 2) {
                    return false;
                }
                search(val)
            }
            
            function initTopSearch(e) {
                e.preventDefault();
                const val = searchInput2.value;
                if(!val.length > 2) {
                    return false;
                }
                search(val)
            }
            
            function closeSearch(e) {
                e.preventDefault();
                searchModal.classList.remove('active');
            }
            
            searchInput1.addEventListener('keypress', e => {
                if (e.key === 'Enter') {
                  initSideSearch(e)
                }
            });
            
            searchInput2.addEventListener('keypress', e => {
                if (e.key === 'Enter') {
                  initTopSearch(e)
                }
            });
            
            searchButton1.addEventListener('click', initSideSearch)
            searchButton2.addEventListener('click', initTopSearch)
            searchModalCloseBtn.addEventListener('click',closeSearch)
            searchModalCloseBg.addEventListener('click',closeSearch)
            searchModalCloseLink.addEventListener('click',closeSearch)
            
        </script></body>
</html>